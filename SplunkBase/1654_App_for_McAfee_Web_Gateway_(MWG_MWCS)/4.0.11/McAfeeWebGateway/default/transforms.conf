[0_delete_syslog_prefix]
REGEX = ^<\d+>\w+\s+\d+\s+\d\d:\d\d:\d\d\s+[^:]+:\s+(.*)$
FORMAT = $1
DEST_KEY = _raw


#[delete_non_mwg_events_sent_via_syslog]
# MWG sends system events via deamon.info. Fiter out anything that doesn't look like a timestamp:
#
# DateTime.ToISOString (2010-03-22 11:45:12)
# REGEX = ^(?!\d\d\d\d\-\d\d\-\d\d)
#
# DateTime.ToGMTString (Mon, 22 March 2010 11:45:36 GMT)
# REGEX = ^(?![A-Z][a-z]{2},\s+\d\d\s+[A-Z][a-z]{1,10}\s+\d\d\d\d)
#
# DateTime.ToNumber (Unix epoch time - 1512915182)
# REGEX = ^(?!\s{10})
#
# DateTime.ToWebReporterString ("29/Oct/2010:14:28:15 +0000")
# REGEX = ^(?!\[\d\d/[A-Z][a-z]{1,10}/\d\d\d\d)
#
#
#DEST_KEY=queue
#FORMAT=nullQueue

[delete_header_line]
REGEX = ^#
DEST_KEY=queue
FORMAT=nullQueue

[extract_watchlist]
REGEX = ([a-f0-9]+):([^:]+):([^";]+)
FORMAT = file_hash::$1 file_name::$2 ensured_mediatypes::$3
SOURCE_KEY = watchlist
MV_ADD = true

[cntx]
REGEX = \s(cntx)\s
FORMAT = ssl_client_context_is_applied::true tvar::$1

[ccert]
REGEX = \s(ccert)\s
FORMAT = ssl_server_handshake_cert_requested::true tvar::$1

[tcn]
REGEX = \s(tcn)\s
FORMAT = ssl_transparent_cn_handling::true tvar::$1

[rqcompst]
REGEX = \s(rqcompst)\s
FORMAT = request_is_composite_object::true tvar::$1

[rscompst]
REGEX = \s(rscompst)\s
FORMAT = response_is_composite_object::true tvar::$1

[caic]
REGEX = \s(caic)\s
FORMAT = is_cacheable::true tvar::$1

[caif]
REGEX = \s(caif)\s
FORMAT = is_fresh::true tvar::$1

[mbmismatch]
REGEX = \s(mbmismatch)\s
FORMAT = magic_bytes_mismatch::true tvar::$1

[ctmt0]
REGEX = \s(ctmt0)\s
FORMAT = both_content_type_and_ensured_type_are_empty::true tvar::$1

[ct-mt]
REGEX = \s(ct-mt)\s
FORMAT = content_type_equals_ensured_type::true tvar::$1

[stream]
REGEX = \s(stream)\s
FORMAT = is_media_stream::true tvar::$1

[tunnel]
REGEX = \s(tunnel)\s
FORMAT = tunnel_enabled::true tvar::$1

[rstc]
REGEX = \s(rstc)\s
FORMAT = gti_request_sent_to_cloud::true tvar::$1

[bydcc]
REGEX = \s(bydcc)\s
FORMAT = result_computed_by_dcc::true tvar::$1

[fwddns]
REGEX = \s(fwddns)\s
FORMAT = forward_dns_led_to_result::true tvar::$1

[revdns]
REGEX = \s(revdns)\s
FORMAT = reverse_dns_led_to_result::true tvar::$1

[cloudlkp]
REGEX = \s(cloudlkp)\s
FORMAT = cloud_lookup_led_to_result::true tvar::$1

[frepgd]
REGEX = \s(frepgood)\s
FORMAT = file_reputation_good::true tvar::$1

[frepknwn]
REGEX = \s(frepknwn)\s
FORMAT = file_reputation_known::true tvar::$1

[frepbd]
REGEX = \s(frepbd)\s
FORMAT = file_reputation_bad::true tvar::$1

[mwg_block_reason_lookup]
filename = mwg_block_reason.csv 

[mwg_url_categories_lookup]
filename = mwg_url_categories.csv

[mwg_openssl_hex_codes_mapping]
filename = mwg_openssl_hex_codes_mapping.csv


# OLD MWGaccess3 format for McAfee Webgateway App v3.0.7
[mwg_status_code]
REGEX = status\=\"([^\/]+)\/
FORMAT = status_code::$1

[mwg_blockid]
REGEX = status\=\"[^\/]+\/([^\"]+)\"
FORMAT = blockID::$1

[mwg_connect_protocol]
REGEX = proto\=\"([^\/]+)\/
FORMAT = connect_protocol::$1

[mwg_url_protocol]
REGEX = proto\=\"[^\/]+\/([^\"]+)\"
FORMAT = url_protocol::$1

[mwg_time_dns]
REGEX = lat\=\"([^\/]+)\/
FORMAT = time_DNS::$1

[mwg_time_connect]
REGEX = lat\=\"[^\/]+\/([^\/]+)\/
FORMAT = time_connect::$1

[mwg_rule]
REGEX = rule\=\"([^\"]+)\"
FORMAT = rule::$1

[mwg_time_server]
REGEX = lat\=\"[^\/]+\/[^\/]+\/([^\/]+)\/
FORMAT = time_server::$1

[mwg_time_total]
REGEX = lat\=\"[^\/]+\/[^\/]+\/[^\/]+\/([^\"]+)\"
FORMAT = time_total::$1

[mwg_bytes_from_client]
REGEX = bytes\=\"([^\/]+)\/
FORMAT = bytes_from_client::$1

[mwg_bytes_to_server]
REGEX = bytes\=\"[^\/]+\/([^\/]+)\/
FORMAT = bytes_to_server::$1

[mwg_bytes_from_server]
REGEX = bytes\=\"[^\/]+\/[^\/]+\/([^\/]+)\/
FORMAT = bytes_from_server::$1

[mwg_bytes_to_client]
REGEX = bytes\=\"[^\/]+\/[^\/]+\/[^\/]+\/([^\"]+)\"
FORMAT = bytes_to_client::$1

[mwg_bytes]
DEFAULT_VALUE = 0
REGEX = bytes\=\"[^\/]+\/[^\/]+\/([^\/]+)\/
FORMAT = bytes::$1

[mwg_http_user_agent]
REGEX = ua\=\"([^\"]+)\"
FORMAT = http_user_agent::$1

[mwg_src]
REGEX = srcip\=\"([^\"]+)\"
FORMAT = src::$1

[mwg_dst]
REGEX = dstip\=\"([^\"]+)\"
FORMAT = dst::$1

[mwg_mlwr]
REGEX = mlwr\=\"([^\"]+)\"
FORMAT = mlwr::$1

[mwg_http_referrer]
REGEX = ref\=(http[\%3A|\:][^\"]+)\"
FORMAT = http_referrer::$1

[mwg_http_method]
REGEX = mtd\=\"([^\"]+)\"
FORMAT = http_method::$1

[mwg_app]
REGEX = app\=\"([^\"]+)\"
FORMAT = app::$1

[mwg_http_content_type]
REGEX = mt\=\"([^\"]+)\"
FORMAT = http_content_type::$1

[mwg_dest]
REGEX = dhost\=\"([^\"]+)\"
FORMAT = dest::$1

[mwg_user]
REGEX = user\=\"([^\"]+)\"
FORMAT = user::$1

[mwg_url]
REGEX = url\=\"([^\"]+)\"
FORMAT = url::$1

[mwg_category]
REGEX = urlc\=\"([^\"]+)\"
FORMAT = category::$1

[mwg_rep]
REGEX = rep\=\"([^\"]+)\"
FORMAT = rep::$1

[mwg_dest_port]
REGEX = urlp\=\"([^\"]+)\"
FORMAT = dest_port::$1

[mwg_vendor_info_lookup]
filename = mwg_vendor_info.csv

[mwg_action_lookup]
filename = mwg_action_info.csv

#GTI has a reputation system of -127 to 127, where -127 is 100% safe and 127 is 100% evil
[mwg_severity_lookup]
filename = mwg_severities.csv

[0_delete_wgcs_header_line]
REGEX = ^"user_id"
DEST_KEY=queue
FORMAT=nullQueue

[delete_underscore_lines]
REGEX = ^_+$
DEST_KEY = queue
FORMAT = nullQueue

[delete_empty_lines]
REGEX = ^[\r\n]+$
DEST_KEY = queue
FORMAT = nullQueue

[audit_extract_kv]
# https://wiki.splunk.com/Community:Multi-line_Events_Multi-value_Field_Extraction
REGEX = ^(?:(\w[\w\s]*\w)\s*: (.*?))(?:[\r\n]|$)
FORMAT = $1::$2
MV_ADD = true

[audit_extract_details]
#REGEX = (?ms)Details: (.*?)
REGEX = (?ms)Details:\s*(.*)
FORMAT = details::$1 

[mwg_audit_action_lookup]
filename = mwg_audit_actions.csv

