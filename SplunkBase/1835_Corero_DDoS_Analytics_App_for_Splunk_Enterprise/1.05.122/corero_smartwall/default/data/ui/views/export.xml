<form>
  <label>Export</label>
  <description>Perform freeform queries against a sites statistical and event data.</description>
  <fieldset autoRun="false">
        <input type="dropdown" token="deployment">
            <label>Site</label>
            <populatingSearch fieldForValue="query" fieldForLabel="description">
                <![CDATA[| rest /services/authentication/current-context splunk_server=local | fields + username | lookup sites user as username OUTPUT user, description, query | append [ | rest /services/authentication/current-context splunk_server=local | eval username="all" | lookup sites user as username OUTPUT user, description, query ] | eval myzip=mvzip(description, query) | table myzip | mvexpand myzip | rex field=myzip "(?<description>[^,]+),(?<query>[^,]+)" | fields - myzip | sort description]]>
            </populatingSearch>
            <selectFirstChoice>true</selectFirstChoice>
        </input>
    <input type="time">
      <label>Time Frame</label>
      <default>
        <earliestTime>@d</earliestTime>
        <latestTime>now</latestTime>
      </default>
    </input>
    <input type="text" token="searchModifier">
      <label>Search Modifier</label>
      <default>*</default>
    </input>
  </fieldset>
  <row>
    <html>
      <p>Use the search modifier to filter the events shown below.  Refer to Corero's Syslog format document for additional detail on the supported fields. <br></br><br></br>  <strong>Example:</strong>To filter on events from clients on the 172.16.0.0/16 and 192.168.1.0/24 subnets going to all servers on port 80.<br></br><strong>Syntax:</strong> (sip=172.16.* OR sip=192.168.1.*) AND dprt=80</p>
    </html>
  </row>
  <row>
    <event>
      <title>Syslog Format</title>
      <searchString>splunk_server=* $deployment$ $searchModifier$ | sort +time limit=50000
      </searchString>
    </event>
  </row>
  <row>
    <event>
      <title>PDU data</title>
      <searchString>splunk_server=* $deployment$ pdu=* $searchModifier$ | sort +time limit=50000 |`pduhexdump`</searchString>
    </event>
  </row>
</form>
